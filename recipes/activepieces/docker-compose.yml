services:
  activepieces:
    image: activepieces/activepieces:latest
    container_name: sulla_activepieces
    ports:
      - "30120:80"
    volumes:
      - /var/lib/sulla/activepieces:/root/.activepieces
    environment:
      - AP_REDIS_TYPE=MEMORY
      - AP_DB_TYPE=PGLITE
      - AP_FRONTEND_URL=http://127.0.0.1:30120
      - AP_SIGN_UP_ENABLED=false
      - AP_TELEMETRY_ENABLED=false
      - AP_ENVIRONMENT=prod
      - AP_JWT_SECRET={{sullaServicePassword|md5}}{{sullaN8nEncryptionKey|md5}}
      - AP_ENCRYPTION_KEY={{sullaN8nEncryptionKey|md5}}
      - AP_LOG_LEVEL=info
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:80/"]
      interval: 30s
      timeout: 10s
      retries: 5
