services:
  comfyui:
    image: byrdziak/comfyui:latest
    container_name: comfyui
    init: true
    restart: unless-stopped
    ports:
      - "30340:8188"
    volumes:
      - comfyui-models:/app/models
      - comfyui-input:/app/input
      - comfyui-output:/app/output
      - comfyui-workflows:/app/user/default/workflows
      - comfyui-custom-nodes:/app/custom_nodes
    healthcheck:
      test: ["CMD-SHELL", "curl -sf http://localhost:8188/ || exit 1"]
      interval: 30s
      timeout: 10s
      retries: 5
      start_period: 120s

volumes:
  comfyui-models:
  comfyui-input:
  comfyui-output:
  comfyui-workflows:
  comfyui-custom-nodes:
